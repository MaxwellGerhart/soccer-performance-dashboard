{% extends "layout.html" %}

{% block content %}
<div class="mb-3">
  <a href="{{ url_for('show_players') }}" class="btn btn-secondary">
    <i class="fas fa-arrow-left"></i> Back to Players
  </a>
  <a href="{{ url_for('home') }}" class="btn btn-primary">
    <i class="fas fa-home"></i> Home
  </a>
</div>

<div class="row">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h2 class="mb-0">
          <i class="fas fa-user"></i> {{ player.player_name }}
          <span class="badge bg-primary ms-2">{{ player.team_name }}</span>
        </h2>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <h5>Offensive Stats</h5>
            <table class="table table-sm">
              <tr>
                <td><i class="fas fa-futbol text-success"></i> Goals</td>
                <td><strong>{{ player.goals }}</strong></td>
              </tr>
              <tr>
                <td><i class="fas fa-hands-helping text-info"></i> Assists</td>
                <td><strong>{{ player.assists }}</strong></td>
              </tr>
              <tr>
                <td><i class="fas fa-chart-line text-warning"></i> Expected Goals (xG)</td>
                <td><strong>{{ player.xg }}</strong></td>
              </tr>
              <tr>
                <td><i class="fas fa-chart-line text-warning"></i> Expected Assists (xA)</td>
                <td><strong>{{ player.xa }}</strong></td>
              </tr>
              <tr>
                <td><i class="fas fa-crosshairs text-danger"></i> Shots</td>
                <td><strong>{{ player.shots }}</strong></td>
              </tr>
            </table>
          </div>
          <div class="col-md-6">
            <h5>Passing & Other Stats</h5>
            <table class="table table-sm">
              <tr>
                <td><i class="fas fa-exchange-alt text-primary"></i> Passes Completed</td>
                <td><strong>{{ player.passes_completed }}</strong></td>
              </tr>
              <tr>
                <td><i class="fas fa-percentage text-success"></i> Pass Completion %</td>
                <td><strong>{{ player.pass_completion }}%</strong></td>
              </tr>
              <tr>
                <td><i class="fas fa-shield-alt text-info"></i> Tackles Won</td>
                <td><strong>{{ player.tackles_won }}</strong></td>
              </tr>
              <tr>
                <td><i class="fas fa-running text-secondary"></i> Total Events</td>
                <td><strong>{{ player.total_events }}</strong></td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-4">
    {% if player.traits %}
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-brain"></i> Player Traits</h5>
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label class="form-label">Spatial Awareness Score (SAS)</label>
          <div class="progress mb-1">
            <div class="progress-bar bg-success" role="progressbar" 
                 style="width: {{ (player.traits.spatial_awareness_score / 100) * 100 }}%">
              {{ "%.1f"|format(player.traits.spatial_awareness_score) }}
            </div>
          </div>
        </div>
        
        <div class="mb-3">
          <label class="form-label">Decision Efficiency Index (DEI)</label>
          <div class="progress mb-1">
            <div class="progress-bar bg-info" role="progressbar" 
                 style="width: {{ (player.traits.decision_efficiency_index / 100) * 100 }}%">
              {{ "%.1f"|format(player.traits.decision_efficiency_index) }}
            </div>
          </div>
        </div>
        
        <div class="mb-3">
          <label class="form-label">Technical Execution Quotient (TEQ)</label>
          <div class="progress mb-1">
            <div class="progress-bar bg-warning" role="progressbar" 
                 style="width: {{ (player.traits.technical_execution_quotient / 100) * 100 }}%">
              {{ "%.1f"|format(player.traits.technical_execution_quotient) }}
            </div>
          </div>
        </div>
        
        <div class="mb-3">
          <label class="form-label">Composite Score</label>
          <div class="progress mb-1">
            <div class="progress-bar bg-danger" role="progressbar" 
                 style="width: {{ (player.traits.composite_score / 100) * 100 }}%">
              {{ "%.1f"|format(player.traits.composite_score) }}
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
    
    <div class="card mt-3">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-clock"></i> Recent Events</h5>
      </div>
      <div class="card-body">
        <div class="list-group list-group-flush">
          {% for event in recent_events %}
          <div class="list-group-item d-flex justify-content-between align-items-center">
            <span>{{ event.type_name }}</span>
            <small class="text-muted">{{ event.minute }}' (P{{ event.period }})</small>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

{% if player.goals > 0 or player.assists > 0 %}
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-chart-bar"></i> Performance Summary</h5>
      </div>
      <div class="card-body">
        <div class="row text-center">
          <div class="col-md-3">
            <div class="stat-card">
              <div class="stat-number text-success">{{ player.goals }}</div>
              <div class="stat-label">Goals</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stat-card">
              <div class="stat-number text-info">{{ player.assists }}</div>
              <div class="stat-label">Assists</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stat-card">
              <div class="stat-number text-warning">{{ player.xg }}</div>
              <div class="stat-label">Expected Goals</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stat-card">
              <div class="stat-number text-danger">{{ player.xa }}</div>
              <div class="stat-label">Expected Assists</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}

<style>
.stat-card {
  padding: 20px;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  background-color: #f8f9fa;
}

.stat-number {
  font-size: 2rem;
  font-weight: bold;
  margin-bottom: 5px;
}

.stat-label {
  font-size: 0.9rem;
  color: #6c757d;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.progress {
  height: 20px;
}

.progress-bar {
  font-size: 0.8rem;
  line-height: 20px;
}
</style>
{% endblock %}
