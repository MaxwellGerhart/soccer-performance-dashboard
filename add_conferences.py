# NCAA Division I Soccer Conference Mappings
CONFERENCE_MAPPINGS = {
    # ACC (Atlantic Coast Conference)
    'Clemson': 'ACC',
    'Duke': 'ACC', 
    'North Carolina': 'ACC',
    'NC State': 'ACC',
    'Wake Forest': 'ACC',
    'Virginia': 'ACC',
    'Virginia Tech': 'ACC',
    'Louisville': 'ACC',
    'Pittsburgh': 'ACC',
    'Syracuse': 'ACC',
    'Boston College': 'ACC',
    'Miami (FL)': 'ACC',
    'Florida St.': 'ACC',
    'Georgia Tech': 'ACC',
    'Notre Dame': 'ACC',
    
    # Big Ten
    'Ohio St.': 'Big Ten',
    'Michigan': 'Big Ten',
    'Michigan St.': 'Big Ten',
    'Penn St.': 'Big Ten',
    'Indiana': 'Big Ten',
    'Maryland': 'Big Ten',
    'Rutgers': 'Big Ten',
    'Northwestern': 'Big Ten',
    'Wisconsin': 'Big Ten',
    'Minnesota': 'Big Ten',
    'Iowa': 'Big Ten',
    'Illinois': 'Big Ten',
    'Nebraska': 'Big Ten',
    'Purdue': 'Big Ten',
    
    # Big 12
    'Kansas': 'Big 12',
    'Texas': 'Big 12',
    'Texas Tech': 'Big 12',
    'TCU': 'Big 12',
    'Baylor': 'Big 12',
    'Oklahoma St.': 'Big 12',
    'West Virginia': 'Big 12',
    'Kansas St.': 'Big 12',
    
    # SEC (Southeastern Conference) 
    'Kentucky': 'SEC',
    'South Carolina': 'SEC',
    'Tennessee': 'SEC',
    'Vanderbilt': 'SEC',
    'Georgia': 'SEC',
    'Florida': 'SEC',
    'Alabama': 'SEC',
    'Auburn': 'SEC',
    'Arkansas': 'SEC',
    'Mississippi St.': 'SEC',
    'Ole Miss': 'SEC',
    'LSU': 'SEC',
    'Missouri': 'SEC',
    'Texas A&M': 'SEC',
    
    # Pac-12
    'Stanford': 'Pac-12',
    'California': 'Pac-12',
    'UCLA': 'Pac-12',
    'USC': 'Pac-12',
    'Oregon': 'Pac-12',
    'Oregon St.': 'Pac-12',
    'Washington': 'Pac-12',
    'Washington St.': 'Pac-12',
    'Arizona': 'Pac-12',
    'Arizona St.': 'Pac-12',
    'Colorado': 'Pac-12',
    'Utah': 'Pac-12',
    
    # American Athletic Conference
    'SMU': 'American',
    'Temple': 'American',
    'Memphis': 'American',
    'Cincinnati': 'American',
    'Houston': 'American',
    'UCF': 'American',
    'USF': 'American',
    'Tulsa': 'American',
    'Tulane': 'American',
    'Navy': 'American',
    'ECU': 'American',
    'Wichita St.': 'American',
    
    # Big East
    'Georgetown': 'Big East',
    'Creighton': 'Big East',
    'Marquette': 'Big East',
    'St. John\'s': 'Big East',
    'DePaul': 'Big East',
    'Seton Hall': 'Big East',
    'Providence': 'Big East',
    'Villanova': 'Big East',
    'Butler': 'Big East',
    'Xavier': 'Big East',
    
    # Atlantic 10
    'Saint Louis': 'Atlantic 10',
    'Fordham': 'Atlantic 10',
    'George Mason': 'Atlantic 10',
    'George Washington': 'Atlantic 10',
    'Davidson': 'Atlantic 10',
    'VCU': 'Atlantic 10',
    'Richmond': 'Atlantic 10',
    'Dayton': 'Atlantic 10',
    'Saint Joseph\'s': 'Atlantic 10',
    'La Salle': 'Atlantic 10',
    'Massachusetts': 'Atlantic 10',
    'Rhode Island': 'Atlantic 10',
    'St. Bonaventure': 'Atlantic 10',
    'Duquesne': 'Atlantic 10',
    
    # Colonial Athletic Association (CAA)
    'Delaware': 'CAA',
    'Drexel': 'CAA',
    'Hofstra': 'CAA',
    'Northeastern': 'CAA',
    'Towson': 'CAA',
    'UNC Wilmington': 'CAA',
    'William & Mary': 'CAA',
    'Elon': 'CAA',
    'James Madison': 'CAA',
    
    # Conference USA
    'Marshall': 'Conference USA',
    'Charlotte': 'Conference USA',
    'UAB': 'Conference USA',
    'Florida Atlantic': 'Conference USA',
    'FIU': 'Conference USA',
    'Old Dominion': 'Conference USA',
    'WKU': 'Conference USA',
    
    # Ivy League
    'Harvard': 'Ivy League',
    'Yale': 'Ivy League',
    'Princeton': 'Ivy League',
    'Penn': 'Ivy League',
    'Columbia': 'Ivy League',
    'Cornell': 'Ivy League',
    'Brown': 'Ivy League',
    'Dartmouth': 'Ivy League',
    
    # Missouri Valley Conference (MVC)
    'Missouri St.': 'MVC',
    'Bradley': 'MVC',
    'Drake': 'MVC',
    'Evansville': 'MVC',
    'Illinois St.': 'MVC',
    'Indiana St.': 'MVC',
    'Loyola Chicago': 'MVC',
    'Northern Iowa': 'MVC',
    'Southern Illinois': 'MVC',
    'Valparaiso': 'MVC',
    
    # Horizon League
    'Milwaukee': 'Horizon League',
    'Wright St.': 'Horizon League',
    'Cleveland St.': 'Horizon League',
    'Detroit Mercy': 'Horizon League',
    'Green Bay': 'Horizon League',
    'Oakland': 'Horizon League',
    'Purdue Fort Wayne': 'Horizon League',
    'Robert Morris': 'Horizon League',
    'Youngstown St.': 'Horizon League',
    
    # Summit League
    'Denver': 'Summit League',
    'Oral Roberts': 'Summit League',
    'Omaha': 'Summit League',
    'North Dakota St.': 'Summit League',
    'South Dakota St.': 'Summit League',
    'Kansas City': 'Summit League',
    'Western Illinois': 'Summit League',
    
    # WAC (Western Athletic Conference)
    'Grand Canyon': 'WAC',
    'Seattle U': 'WAC',
    'Utah Valley': 'WAC',
    'CSU Bakersfield': 'WAC',
    'Chicago St.': 'WAC',
    'New Mexico St.': 'WAC',
    'Utah Tech': 'WAC',
    
    # Big South
    'Liberty': 'Big South',
    'Campbell': 'Big South',
    'Charleston Southern': 'Big South',
    'Gardner-Webb': 'Big South',
    'High Point': 'Big South',
    'Longwood': 'Big South',
    'Presbyterian': 'Big South',
    'Radford': 'Big South',
    'UNC Asheville': 'Big South',
    'Winthrop': 'Big South',
    
    # MAAC (Metro Atlantic Athletic Conference)
    'Canisius': 'MAAC',
    'Fairfield': 'MAAC',
    'Iona': 'MAAC',
    'Manhattan': 'MAAC',
    'Marist': 'MAAC',
    'Monmouth': 'MAAC',
    'Niagara': 'MAAC',
    'Quinnipiac': 'MAAC',
    'Rider': 'MAAC',
    'Saint Peter\'s': 'MAAC',
    'Siena': 'MAAC',
    
    # Patriot League
    'American': 'Patriot League',
    'Army West Point': 'Patriot League',
    'Bucknell': 'Patriot League',
    'Colgate': 'Patriot League',
    'Holy Cross': 'Patriot League',
    'Lafayette': 'Patriot League',
    'Lehigh': 'Patriot League',
    'Loyola Maryland': 'Patriot League',
    'Navy': 'American',  # Navy is in American for soccer
    
    # America East
    'UAlbany': 'America East',
    'Binghamton': 'America East',
    'Hartford': 'America East',
    'Maine': 'America East',
    'New Hampshire': 'America East',
    'Stony Brook': 'America East',
    'UMass Lowell': 'America East',
    'Vermont': 'America East',
    'UMBC': 'America East',
    
    # Southern Conference (SoCon)
    'Furman': 'Southern Conference',
    'Mercer': 'Southern Conference',
    'UNC Greensboro': 'Southern Conference',
    'VMI': 'Southern Conference',
    'Western Carolina': 'Southern Conference',
    'Wofford': 'Southern Conference',
    'Chattanooga': 'Southern Conference',
    'ETSU': 'Southern Conference',
    'Samford': 'Southern Conference',
    'The Citadel': 'Southern Conference',
    
    # Sun Belt Conference
    'Coastal Carolina': 'Sun Belt',
    'Georgia St.': 'Sun Belt',
    'Georgia Southern': 'Sun Belt',
    'Appalachian St.': 'Sun Belt',
    'Marshall': 'Conference USA',  # Marshall moved to Conference USA
    
    # Atlantic Sun (ASUN)
    'Bellarmine': 'ASUN',
    'Central Ark.': 'ASUN',
    'Eastern Kentucky': 'ASUN',
    'Lipscomb': 'ASUN',
    'North Alabama': 'ASUN',
    'North Florida': 'ASUN',
    'Stetson': 'ASUN',
    'Austin Peay': 'ASUN',
    'Jacksonville': 'ASUN',
    
    # Big Sky Conference
    'Montana': 'Big Sky',
    'Montana St.': 'Big Sky',
    'Portland St.': 'Big Sky',
    'Sacramento St.': 'Big Sky',
    'Weber St.': 'Big Sky',
    'Idaho St.': 'Big Sky',
    'Northern Arizona': 'Big Sky',
    'Northern Colorado': 'Big Sky',
    
    # Big West
    'UC Davis': 'Big West',
    'UC Irvine': 'Big West',
    'UC Riverside': 'Big West',
    'UC Santa Barbara': 'Big West',
    'Cal Poly': 'Big West',
    'CSU Fullerton': 'Big West',
    'CSU Northridge': 'Big West',
    'Long Beach St.': 'Big West',
    'Hawaii': 'Big West',
    
    # Mountain West
    'Air Force': 'Mountain West',
    'Colorado St.': 'Mountain West',
    'New Mexico': 'Mountain West',
    'San Diego St.': 'Mountain West',
    'San Jose St.': 'Mountain West',
    'UNLV': 'Mountain West',
    'Utah St.': 'Mountain West',
    'Wyoming': 'Mountain West',
    'Boise St.': 'Mountain West',
    'Fresno St.': 'Mountain West',
    'Nevada': 'Mountain West',
    
    # Northeast Conference (NEC)
    'Bryant': 'NEC',
    'Central Conn. St.': 'NEC',
    'Fairleigh Dickinson': 'NEC',
    'LIU': 'NEC',
    'Merrimack': 'NEC',
    'Mount St. Mary\'s': 'NEC',
    'Sacred Heart': 'NEC',
    'Saint Francis PA': 'NEC',
    'Wagner': 'NEC',
    
    # Ohio Valley Conference (OVC)
    'Belmont': 'OVC',
    'Eastern Illinois': 'OVC',
    'Morehead St.': 'OVC',
    'Murray St.': 'OVC',
    'Southeast Missouri': 'OVC',
    'Southern Indiana': 'OVC',
    'Tennessee Martin': 'OVC',
    'Tennessee St.': 'OVC',
    'Tennessee Tech': 'OVC',
    
    # Southland Conference
    'Houston Christian': 'Southland',
    'Incarnate Word': 'Southland',
    'Lamar': 'Southland',
    'McNeese': 'Southland',
    'New Orleans': 'Southland',
    'Nicholls': 'Southland',
    'Northwestern St.': 'Southland',
    'SE Louisiana': 'Southland',
    'Texas A&M-Commerce': 'Southland',
    'Texas A&M-Corpus Christi': 'Southland',
    
    # SWAC (Southwestern Athletic Conference)
    'Alabama A&M': 'SWAC',
    'Alabama St.': 'SWAC',
    'Alcorn St.': 'SWAC',
    'Bethune-Cookman': 'SWAC',
    'Florida A&M': 'SWAC',
    'Grambling': 'SWAC',
    'Jackson St.': 'SWAC',
    'Mississippi Valley St.': 'SWAC',
    'Prairie View A&M': 'SWAC',
    'Southern': 'SWAC',
    'Texas Southern': 'SWAC',
    
    # West Coast Conference (WCC)
    'Gonzaga': 'WCC',
    'Loyola Marymount': 'WCC',
    'Pepperdine': 'WCC',
    'Portland': 'WCC',
    'Saint Mary\'s': 'WCC',
    'San Diego': 'WCC',
    'San Francisco': 'WCC',
    'Santa Clara': 'WCC',
    'BYU': 'WCC',
    'Pacific': 'WCC',
}

import sqlite3
import pandas as pd

def add_conference_to_database():
    """Add conference column to players table and populate it"""
    conn = sqlite3.connect('data/ncaa_soccer.db')
    cursor = conn.cursor()
    
    # Add conference column if it doesn't exist
    try:
        cursor.execute("ALTER TABLE players ADD COLUMN conference TEXT")
        print("Added conference column to players table")
    except sqlite3.OperationalError as e:
        if "duplicate column name" in str(e):
            print("Conference column already exists")
        else:
            raise e
    
    # Update players with conference information
    updated_count = 0
    for team, conference in CONFERENCE_MAPPINGS.items():
        cursor.execute("UPDATE players SET conference = ? WHERE team = ?", (conference, team))
        updated_count += cursor.rowcount
    
    # Set remaining teams to "Other" conference
    cursor.execute("UPDATE players SET conference = 'Other' WHERE conference IS NULL")
    other_count = cursor.rowcount
    
    conn.commit()
    conn.close()
    
    print(f"Updated {updated_count} players with known conferences")
    print(f"Set {other_count} players to 'Other' conference")
    
    # Show conference distribution
    conn = sqlite3.connect('data/ncaa_soccer.db')
    cursor = conn.cursor()
    cursor.execute("SELECT conference, COUNT(*) as player_count FROM players GROUP BY conference ORDER BY player_count DESC")
    conferences = cursor.fetchall()
    print("\nConference distribution:")
    for conf, count in conferences:
        print(f"  {conf}: {count} players")
    conn.close()

if __name__ == "__main__":
    add_conference_to_database()
